Search.setIndex({"docnames": ["api/python/index", "index", "start/install", "start/quick_start", "tutorials/structured_generation"], "filenames": ["api/python/index.rst", "index.rst", "start/install.rst", "start/quick_start.rst", "tutorials/structured_generation.rst"], "titles": ["xgrammar", "\ud83d\udc4b Welcome to XGrammar", "Installation", "Quick Start", "Structured Generation"], "terms": {"class": [0, 4], "function": [0, 4], "compiledgrammar": [0, 4], "thi": [0, 1, 2, 3, 4], "i": [0, 1, 2, 3, 4], "primari": 0, "object": [0, 4], "store": 0, "compil": [0, 2, 4], "grammar": [0, 4], "A": [0, 2], "can": [0, 2, 3, 4], "us": [0, 1, 2, 3, 4], "construct": [0, 3, 4], "grammarmatch": [0, 4], "gener": [0, 1], "token": [0, 3, 4], "mask": [0, 4], "effici": [0, 4], "do": 0, "directli": [0, 2], "instead": 0, "grammarcompil": [0, 3, 4], "attribut": 0, "properti": [0, 4], "The": [0, 1, 3, 4], "origin": 0, "tokenizer_info": [0, 3, 4], "tokenizerinfo": [0, 3, 4], "info": [0, 4], "associ": 0, "repres": 0, "later": [0, 4], "guid": [0, 3], "support": [0, 2, 4], "context": 0, "free": 0, "cfg": 0, "ebnf": [0, 3], "extend": 0, "backu": 0, "naur": 0, "form": 0, "format": [0, 4], "There": 0, "ar": [0, 2, 3, 4], "mani": 0, "specif": [0, 2, 3, 4], "literatur": 0, "we": [0, 2, 4], "follow": [0, 2, 3, 4], "gbnf": [0, 3, 4], "ggml": [0, 4], "bnf": [0, 4], "http": [0, 2], "github": [0, 1, 2, 3], "com": [0, 2], "ggerganov": 0, "llama": [0, 3], "cpp": 0, "blob": 0, "master": 0, "readm": 0, "md": 0, "when": [0, 2], "print": [0, 2, 3], "convert": 0, "method": [0, 4], "static": 0, "builtin_json_grammar": 0, "get": [0, 4], "standard": [0, 2], "json": [0, 3], "compat": 0, "offici": 0, "www": 0, "org": 0, "en": 0, "html": 0, "return": 0, "type": [0, 4], "from_ebnf": 0, "ebnf_str": [0, 3], "str": [0, 4], "root_rule_nam": 0, "root": [0, 4], "from": [0, 3, 4], "string": [0, 3, 4], "should": [0, 2, 4], "paramet": 0, "default": [0, 4], "name": [0, 4], "rule": 0, "from_json_schema": 0, "schema": [0, 3], "union": 0, "basemodel": [0, 4], "indent": 0, "option": 0, "int": [0, 4], "none": 0, "separ": 0, "tupl": 0, "strict_mod": 0, "bool": 0, "true": [0, 3, 4], "pydant": [0, 4], "model": [0, 3, 4], "specifi": 0, "mean": 0, "valu": 0, "convent": 0, "dump": [0, 4], "It": [0, 4], "intern": 0, "number": 0, "space": 0, "If": 0, "output": [0, 4], "one": [0, 4], "line": [0, 2], "two": [0, 4], "comma": 0, "colon": 0, "exampl": [0, 1], "otherwis": 0, "whether": 0, "strict": 0, "mode": 0, "In": [0, 4], "allow": 0, "item": 0, "equival": 0, "set": [0, 2, 4], "unevaluatedproperti": 0, "unevaluateditem": 0, "fals": [0, 3], "help": [0, 3], "llm": [0, 4], "accur": 0, "max_thread": [0, 4], "8": [0, 4], "cache_en": 0, "certain": 0, "parallel": 0, "multipl": 0, "thread": [0, 4], "ha": [0, 2, 4], "cach": [0, 4], "result": 0, "avoid": [0, 2], "same": [0, 4], "time": 0, "maximum": 0, "enabl": [0, 2, 3, 4], "clear_cach": 0, "clear": 0, "all": [0, 4], "compile_builtin_json_grammar": [0, 3, 4], "compiled_grammar": [0, 3, 4], "compile_json_schema": [0, 3, 4], "override_stop_token": 0, "list": [0, 4], "terminate_without_stop_token": 0, "max_rollback_token": 0, "0": [0, 3, 4], "match": 0, "next": [0, 4], "core": [0, 2], "maintain": [0, 4], "state": [0, 4], "matcher": [0, 4], "accept": [0, 4], "them": 0, "provid": [0, 2, 3, 4], "bitmask": [0, 2, 4], "predict": 0, "so": [0, 4], "Its": 0, "reset": [0, 4], "roll": 0, "back": 0, "also": [0, 2, 4], "util": 0, "jump": 0, "forward": 0, "decod": [0, 3], "after": [0, 3], "whole": 0, "stop": [0, 4], "onli": 0, "termin": [0, 4], "cannot": 0, "ani": [0, 3], "new": [0, 3], "finish": 0, "under": 0, "hood": 0, "pushdown": 0, "automaton": 0, "backtrack": 0, "optim": 0, "initi": 0, "overrid": 0, "ones": 0, "without": 0, "rollback": 0, "oper": 0, "specul": 0, "accept_token": [0, 4], "token_id": 0, "debug_print": 0, "updat": [0, 4], "id": 0, "inform": 0, "about": 0, "debug": 0, "fill_next_token_bitmask": [0, 4], "tensor": [0, 4], "index": 0, "fill": 0, "input": [0, 3], "allocate_token_bitmask": [0, 4], "must": 0, "cpu": [0, 3, 4], "doe": 0, "chang": 0, "torch": [0, 2, 3, 4], "batch": 0, "find_jump_forward_str": 0, "find": 0, "longest": 0, "certainli": 0, "conform": 0, "current": [0, 4], "becom": 0, "requir": [0, 4], "jump_forward_str": 0, "is_termin": [0, 4], "check": [0, 1, 3], "num_token": 0, "1": [0, 3, 4], "previou": 0, "sever": 0, "exce": 0, "step": [0, 2, 4], "nor": 0, "stop_token_id": 0, "detect": 0, "vocabulari": 0, "encoded_vocab": 0, "byte": 0, "vocab_typ": 0, "vocabtyp": 0, "raw": 0, "vocab_s": [0, 3, 4], "prepend_space_in_token": 0, "contain": 0, "necessari": [0, 4], "note": [0, 4], "although": 0, "some": 0, "encod": [0, 4], "special": 0, "e": 0, "g": [0, 2], "0x1b": 0, "bytefallback": 0, "\u0121": 0, "level": 0, "bpe": 0, "alwai": [0, 4], "phi": 0, "3": [0, 2, 3, 4], "deepseek": 0, "v2": 0, "mai": [0, 2], "pad": [0, 4], "32": 0, "case": [0, 3, 4], "": [0, 4], "larger": [0, 4], "than": [0, 4], "size": 0, "pleas": [0, 2], "pass": 0, "constructor": 0, "becaus": 0, "determin": 0, "see": [0, 2, 3, 4], "len": [0, 3, 4], "auto": [0, 4], "correct": 0, "prepend": 0, "befor": [0, 4], "text": [0, 3], "process": 0, "decoded_vocab": 0, "dump_metadata": 0, "metadata": 0, "from_huggingfac": [0, 3, 4], "pretrainedtokenizerbas": 0, "huggingfac": 0, "variou": 0, "backend": 0, "includ": 0, "fast": [0, 1], "tiktoken": 0, "automat": 0, "defin": 0, "config": [0, 3, 4], "have": [0, 4], "more": [0, 3], "you": [0, 2, 3, 4], "manual": 0, "from_vocab_and_metadata": 0, "special_token_id": 0, "control": 0, "reserv": 0, "etc": [0, 3], "now": [0, 4], "three": 0, "kept": 0, "kind": 0, "microsoft": 0, "small": 0, "8k": 0, "instruct": [0, 3, 4], "qwen": [0, 4], "7b": 0, "chat": 0, "byte_fallback": 0, "fallback": 0, "through": 0, "convers": 0, "appl": 0, "meta": [0, 3], "2": [0, 4], "5": [0, 4], "mini": 0, "byte_level": 0, "unicod": 0, "transform": [0, 3, 4], "87be06ca77166e6a6215eee5a990ab9f07238a18": 0, "src": 0, "gpt2": 0, "tokenization_gpt2": 0, "py": [0, 2], "l38": 0, "l59": 0, "8b": [0, 3], "batch_siz": [0, 4], "alloc": [0, 4], "For": 0, "an": [0, 2, 3, 4], "int32": 0, "shape": [0, 4], "ceil": 0, "user": [0, 3], "who": 0, "own": [0, 4], "need": [0, 2, 4], "manag": [0, 2], "cuda": [0, 3, 4], "memori": 0, "get_bitmask_shap": 0, "bitmask_dtyp": 0, "themselv": 0, "apply_token_bitmask_inplac": [0, 4], "logit": [0, 4], "indic": 0, "appli": [0, 2, 4], "place": 0, "01": 0, "bitwis": 0, "compress": 0, "where": 0, "inf": 0, "bitmask_s": 0, "respect": 0, "rang": [0, 4], "j": 0, "get_bitmask_valu": 0, "th": 0, "bit": 0, "which": 0, "devic": [0, 3, 4], "both": 0, "launch": 0, "kernel": 0, "implement": 0, "prefer": 0, "open": [1, 3], "sourc": 1, "solut": 1, "flexibl": [1, 3], "portabl": 1, "structur": [1, 3], "mission": 1, "project": 1, "bring": 1, "zero": 1, "overhead": [1, 4], "everywher": 1, "out": [1, 2, 3, 4], "xgrammar": [2, 3], "python": [2, 3], "develop": 2, "built": [2, 3], "nightli": 2, "pip": [2, 4], "wheel": 2, "via": [2, 4], "whenev": 2, "highli": 2, "recommend": [2, 4], "conda": [2, 4], "isol": [2, 4], "environ": [2, 4], "miss": 2, "incompat": 2, "version": 2, "conflict": 2, "make": [2, 4], "sure": [2, 4], "your": [2, 4], "activ": 2, "m": 2, "Then": [2, 4], "verifi": 2, "command": 2, "c": 2, "import": [2, 3, 4], "modul": 2, "path": 2, "env": 2, "lib": 2, "python3": 2, "11": 2, "site": 2, "__init__": 2, "nvidia": 2, "gpu": [2, 4], "extra": 2, "nvrtc": 2, "cu12": 2, "want": 2, "modif": 2, "obtain": 2, "up": [2, 4], "To": 2, "ensur": [2, 4], "satisfi": 2, "cmake": 2, "18": 2, "git": 2, "start": [2, 4], "fresh": 2, "remov": 2, "n": 2, "venv": 2, "creat": 2, "forg": 2, "enter": 2, "ninja": 2, "pybind11": 2, "configur": [2, 4], "base": [2, 4], "workflow": 2, "download": 2, "clone": 2, "recurs": 2, "mlc": 2, "ai": 2, "cd": 2, "bind": 2, "mkdir": 2, "4": 2, "add": 2, "directori": 2, "echo": 2, "export": 2, "pwd": 2, "bashrc": 2, "valid": [2, 4], "successfulli": 2, "easiest": 3, "wai": 3, "try": 3, "librari": [3, 4], "instal": 3, "run": [3, 4], "how": [3, 4], "instanti": [3, 4], "xgr": [3, 4], "automodelforcausallm": 3, "autotoken": [3, 4], "autoconfig": [3, 4], "Or": 3, "model_nam": 3, "from_pretrain": [3, 4], "torch_dtyp": 3, "float32": 3, "device_map": 3, "messag": 3, "role": 3, "system": 3, "content": 3, "assist": 3, "introduc": 3, "yourself": 3, "briefli": 3, "apply_chat_templ": 3, "add_generation_prompt": 3, "model_input": 3, "return_tensor": 3, "pt": 3, "custom": [3, 4], "document": 3, "grammar_compil": 3, "other": 3, "json_schema_str": 3, "compile_grammar": [3, 4], "logits_processor": 3, "xgr_logits_processor": 3, "contrib": 3, "hf": 3, "logitsprocessor": 3, "generated_id": 3, "max_new_token": 3, "512": 3, "input_id": 3, "skip_special_token": 3, "detail": [3, 4], "usag": 3, "report": 3, "problem": 3, "ask": 3, "question": 3, "issu": 3, "our": [3, 4], "repo": 3, "tutori": 4, "go": 4, "over": 4, "adher": 4, "first": 4, "lai": 4, "concept": 4, "final": 4, "demonstr": 4, "work": 4, "therefor": 4, "encourag": 4, "code": 4, "snippet": 4, "below": 4, "actual": 4, "runnabl": 4, "simul": 4, "avail": 4, "virtual": 4, "section": 4, "numpi": 4, "np": 4, "extract": 4, "model_id": 4, "qwen2": 4, "5b": 4, "due": 4, "full_vocab_s": 4, "With": 4, "choic": 4, "here": 4, "behavior": 4, "multithread": 4, "enable_cach": 4, "everi": 4, "thing": 4, "seen": 4, "per": 4, "rather": 4, "main": 4, "interact": 4, "token_bitmask": 4, "singl": 4, "request": 4, "regress": 4, "sampl": 4, "respons": 4, "sim_sampled_respons": 4, "endoftext": 4, "sim_sampled_token_id": 4, "each": 4, "loop": 4, "iter": 4, "sim_token_id": 4, "enumer": 4, "randn": 4, "invalid": 4, "prob": 4, "softmax": 4, "dim": 4, "next_token_id": 4, "random": 4, "p": 4, "its": 4, "enforc": 4, "assert": 4, "inde": 4, "sinc": 4, "readi": 4, "flow": 4, "almost": 4, "ident": 4, "abov": 4, "except": 4, "being": 4, "pick": 4, "person": 4, "ag": 4, "person_schema": 4, "titl": 4, "integ": 4, "remain": 4, "differ": 4, "larg": 4, "ebnf_grammar_str": 4, "expr": 4, "term": 4, "num": 4, "9": 4, "16": 4, "assum": 4, "exact": 4, "sai": 4, "simplic": 4, "thei": 4, "just": 4, "length": 4, "But": 4, "easi": 4, "engin": 4, "kei": 4, "b": 4, "loop_it": 4, "paralleliz": 4, "estim": 4}, "objects": {"": [[0, 0, 0, "-", "xgrammar"]], "xgrammar": [[0, 1, 1, "", "CompiledGrammar"], [0, 1, 1, "", "Grammar"], [0, 1, 1, "", "GrammarCompiler"], [0, 1, 1, "", "GrammarMatcher"], [0, 1, 1, "", "TokenizerInfo"], [0, 1, 1, "", "VocabType"], [0, 4, 1, "", "allocate_token_bitmask"], [0, 4, 1, "", "apply_token_bitmask_inplace"], [0, 4, 1, "", "get_bitmask_shape"]], "xgrammar.CompiledGrammar": [[0, 2, 1, "", "grammar"], [0, 2, 1, "", "tokenizer_info"]], "xgrammar.Grammar": [[0, 3, 1, "", "builtin_json_grammar"], [0, 3, 1, "", "from_ebnf"], [0, 3, 1, "", "from_json_schema"]], "xgrammar.GrammarCompiler": [[0, 3, 1, "", "clear_cache"], [0, 3, 1, "", "compile_builtin_json_grammar"], [0, 3, 1, "", "compile_json_schema"]], "xgrammar.GrammarMatcher": [[0, 3, 1, "", "accept_token"], [0, 3, 1, "", "fill_next_token_bitmask"], [0, 3, 1, "", "find_jump_forward_string"], [0, 3, 1, "", "is_terminated"], [0, 2, 1, "", "max_rollback_tokens"], [0, 3, 1, "", "reset"], [0, 3, 1, "", "rollback"], [0, 2, 1, "", "stop_token_ids"]], "xgrammar.TokenizerInfo": [[0, 2, 1, "", "decoded_vocab"], [0, 3, 1, "", "dump_metadata"], [0, 3, 1, "", "from_huggingface"], [0, 3, 1, "", "from_vocab_and_metadata"], [0, 2, 1, "", "prepend_space_in_tokenization"], [0, 2, 1, "", "special_token_ids"], [0, 2, 1, "", "stop_token_ids"], [0, 2, 1, "", "vocab_size"], [0, 2, 1, "", "vocab_type"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:property", "3": "py:method", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "property", "Python property"], "3": ["py", "method", "Python method"], "4": ["py", "function", "Python function"]}, "titleterms": {"xgrammar": [0, 1, 4], "welcom": 1, "quick": [1, 3], "start": [1, 3], "instal": [2, 4], "tabl": 2, "content": 2, "option": 2, "1": 2, "prebuilt": 2, "packag": 2, "cuda": 2, "depend": 2, "2": 2, "build": 2, "from": 2, "sourc": 2, "exampl": 3, "perpar": 3, "compil": 3, "grammar": 3, "gener": [3, 4], "what": 3, "do": 3, "next": 3, "structur": 4, "json": 4, "schema": 4, "guid": 4, "ebnf": 4, "batch": 4, "infer": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"xgrammar": [[0, "module-xgrammar"]], "\ud83d\udc4b Welcome to XGrammar": [[1, "welcome-to-xgrammar"]], "Quick Start": [[1, "quick-start"], [3, "quick-start"]], "Installation": [[2, "installation"]], "Table of Contents": [[2, "table-of-contents"]], "Option 1. Prebuilt Package": [[2, "option-1-prebuilt-package"]], "CUDA Dependency": [[2, "cuda-dependency"]], "Option 2. Build from Source": [[2, "option-2-build-from-source"]], "Example": [[3, "example"]], "Perparation": [[3, "perparation"]], "Compile Grammar": [[3, "compile-grammar"]], "Generate with grammar": [[3, "generate-with-grammar"]], "What to Do Next": [[3, "what-to-do-next"]], "Structured Generation": [[4, "structured-generation"]], "Install XGrammar": [[4, "install-xgrammar"]], "JSON Generation": [[4, "json-generation"]], "JSON Schema Guided Generation": [[4, "json-schema-guided-generation"]], "EBNF Guided Generation": [[4, "ebnf-guided-generation"]], "Structured Generation for Batched Inference": [[4, "structured-generation-for-batched-inference"]]}, "indexentries": {"compiledgrammar (class in xgrammar)": [[0, "xgrammar.CompiledGrammar"]], "grammar (class in xgrammar)": [[0, "xgrammar.Grammar"]], "grammarcompiler (class in xgrammar)": [[0, "xgrammar.GrammarCompiler"]], "grammarmatcher (class in xgrammar)": [[0, "xgrammar.GrammarMatcher"]], "tokenizerinfo (class in xgrammar)": [[0, "xgrammar.TokenizerInfo"]], "vocabtype (class in xgrammar)": [[0, "xgrammar.VocabType"]], "accept_token() (xgrammar.grammarmatcher method)": [[0, "xgrammar.GrammarMatcher.accept_token"]], "allocate_token_bitmask() (in module xgrammar)": [[0, "xgrammar.allocate_token_bitmask"]], "apply_token_bitmask_inplace() (in module xgrammar)": [[0, "xgrammar.apply_token_bitmask_inplace"]], "builtin_json_grammar() (xgrammar.grammar static method)": [[0, "xgrammar.Grammar.builtin_json_grammar"]], "clear_cache() (xgrammar.grammarcompiler method)": [[0, "xgrammar.GrammarCompiler.clear_cache"]], "compile_builtin_json_grammar() (xgrammar.grammarcompiler method)": [[0, "xgrammar.GrammarCompiler.compile_builtin_json_grammar"]], "compile_json_schema() (xgrammar.grammarcompiler method)": [[0, "xgrammar.GrammarCompiler.compile_json_schema"]], "decoded_vocab (xgrammar.tokenizerinfo property)": [[0, "xgrammar.TokenizerInfo.decoded_vocab"]], "dump_metadata() (xgrammar.tokenizerinfo method)": [[0, "xgrammar.TokenizerInfo.dump_metadata"]], "fill_next_token_bitmask() (xgrammar.grammarmatcher method)": [[0, "xgrammar.GrammarMatcher.fill_next_token_bitmask"]], "find_jump_forward_string() (xgrammar.grammarmatcher method)": [[0, "xgrammar.GrammarMatcher.find_jump_forward_string"]], "from_ebnf() (xgrammar.grammar static method)": [[0, "xgrammar.Grammar.from_ebnf"]], "from_huggingface() (xgrammar.tokenizerinfo static method)": [[0, "xgrammar.TokenizerInfo.from_huggingface"]], "from_json_schema() (xgrammar.grammar static method)": [[0, "xgrammar.Grammar.from_json_schema"]], "from_vocab_and_metadata() (xgrammar.tokenizerinfo static method)": [[0, "xgrammar.TokenizerInfo.from_vocab_and_metadata"]], "get_bitmask_shape() (in module xgrammar)": [[0, "xgrammar.get_bitmask_shape"]], "grammar (xgrammar.compiledgrammar property)": [[0, "xgrammar.CompiledGrammar.grammar"]], "is_terminated() (xgrammar.grammarmatcher method)": [[0, "xgrammar.GrammarMatcher.is_terminated"]], "max_rollback_tokens (xgrammar.grammarmatcher property)": [[0, "xgrammar.GrammarMatcher.max_rollback_tokens"]], "module": [[0, "module-xgrammar"]], "prepend_space_in_tokenization (xgrammar.tokenizerinfo property)": [[0, "xgrammar.TokenizerInfo.prepend_space_in_tokenization"]], "reset() (xgrammar.grammarmatcher method)": [[0, "xgrammar.GrammarMatcher.reset"]], "rollback() (xgrammar.grammarmatcher method)": [[0, "xgrammar.GrammarMatcher.rollback"]], "special_token_ids (xgrammar.tokenizerinfo property)": [[0, "xgrammar.TokenizerInfo.special_token_ids"]], "stop_token_ids (xgrammar.grammarmatcher property)": [[0, "xgrammar.GrammarMatcher.stop_token_ids"]], "stop_token_ids (xgrammar.tokenizerinfo property)": [[0, "xgrammar.TokenizerInfo.stop_token_ids"]], "tokenizer_info (xgrammar.compiledgrammar property)": [[0, "xgrammar.CompiledGrammar.tokenizer_info"]], "vocab_size (xgrammar.tokenizerinfo property)": [[0, "xgrammar.TokenizerInfo.vocab_size"]], "vocab_type (xgrammar.tokenizerinfo property)": [[0, "xgrammar.TokenizerInfo.vocab_type"]], "xgrammar": [[0, "module-xgrammar"]]}})